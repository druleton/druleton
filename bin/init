#!/bin/bash

################################################################################
# Script to initiate or update the project environment.
#
# This will:
# - Create a symlink to any config/bin/commandname from within the bin/
#   directory.
#
# ! Do not change this file !
# All configuration is in the config directory
################################################################################


# Bootstrap the script.
source $(dirname $0)/src/bootstrap.sh


# Show script information.
echo
markup_h1_divider
markup_h1 " ${LWHITE}Initiate/update${LBLUE} environment for website ${WHITE}$SITE_NAME${LBLUE} ($ENVIRONMENT)"
markup_h1_divider
markup_h1_li "Any custom command will be included in the bin/ directory."
markup_h1_divider
echo


# Confirm deletion of files & DB.
if [ $CONFIRMED -ne 1 ]; then
  read -p "Are you sure? (y/N) " -n 1 -r
  echo

  if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    markup_warning "! Init aborted"
    echo
    exit 1
  fi
  echo
fi


# Includes.
source "$DIR_SRC/script.sh"
source "$DIR_SRC/init_composer.sh"
source "$DIR_SRC/init_custom_commands.sh"


# START Script -----------------------------------------------------------------

script_before_run
init_composer_run
init_custom_commands_run
script_after_run

# END Script -------------------------------------------------------------------


# Finish message.
markup_h1_divider
markup_success " Finished"
markup_h1_divider
echo


exit 0
